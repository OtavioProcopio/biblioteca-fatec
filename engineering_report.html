<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Relatório de Engenharia Reversa — Biblioteca</title>
  <style>
    body{font-family:Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial;line-height:1.6;color:#222;background:#f6f8fb;margin:0;padding:32px}
    .container{max-width:960px;margin:0 auto;background:#fff;padding:28px;border-radius:10px;box-shadow:0 6px 24px rgba(20,40,80,0.08)}
    h1{margin-top:0;color:#0b3c78}
    h2{color:#0b3c78;border-bottom:2px solid #eef3fb;padding-bottom:6px}
    p{margin:0 0 12px}
    pre{background:#0e1724;color:#e6eef8;padding:12px;border-radius:6px;overflow:auto}
    code{background:#f1f7ff;padding:2px 6px;border-radius:4px}
    .section{margin-bottom:20px}
    ul{margin:6px 0 12px 20px}
    .tree{font-family:monospace;background:#f7f9fc;padding:12px;border-radius:6px}
    .meta{font-size:0.9rem;color:#556}
    .badge{display:inline-block;background:#e6f0ff;color:#0b3c78;padding:4px 8px;border-radius:6px;font-weight:600;margin-right:8px}
    .footer{font-size:0.85rem;color:#667;margin-top:18px;border-top:1px solid #eef2f8;padding-top:12px}
    .callout{background:#fff8e6;border-left:4px solid #ffd24a;padding:10px;border-radius:6px}
    a.button{display:inline-block;background:#0b63c6;color:#fff;padding:8px 12px;border-radius:6px;text-decoration:none}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Relatório de Engenharia Reversa — Projeto "Biblioteca"</h1>
      <p class="meta">Gerado: 2025-10-08 — Linguagem: Java 17 — Build: Maven</p>
    </header>

    <section class="section">
      <h2>1. Introdução</h2>
      <p>Este documento descreve a engenharia reversa do projeto <strong>Biblioteca</strong>, um protótipo em Java para demonstrar operações básicas de cadastro e listagem de livros e usuários. O sistema é orientado a console e foi desenhado para ser simples, testável e didático.</p>
      <p class="callout"><strong>Objetivo:</strong> Fornecer uma implementação mínima e testável de um repositório de biblioteca com separação de responsabilidades (view, controller, model) e factories para criação de entidades.</p>
    </section>

    <section class="section">
      <h2>2. Requisitos (funcionais e não funcionais)</h2>
      <h3>Requisitos Funcionais</h3>
      <ul>
        <li>RF1: Cadastrar livro (título, autor).</li>
        <li>RF2: Listar livros.</li>
        <li>RF3: Remover livro.</li>
        <li>RF4: Cadastrar usuário (aluno|professor|bibliotecario).</li>
        <li>RF5: Listar usuários.</li>
        <li>RF6: Validar tipo de usuário; lançar erro em tipo inválido.</li>
        <li>RF7: Emprestar e devolver livros via métodos de entidade (com validação de disponibilidade).</li>
        <li>RF8: Interface de console com menu interativo.</li>
      </ul>
      <h3>Requisitos Não Funcionais</h3>
      <ul>
        <li>RNF1: Simplicidade e leveza — repositório em memória.</li>
        <li>RNF2: Portabilidade — Java 17 / Maven.</li>
        <li>RNF3: Testabilidade — controller desacoplado por interface.</li>
        <li>RNF4: Imutabilidade das listas retornadas (proteção contra alteração externa).</li>
        <li>RNF5: Operação síncrona e sem requisitos de concorrência.</li>
      </ul>
    </section>

    <section class="section">
      <h2>3. Diagramas UML (em formato de árvore)</h2>
      <h3>3.1 Casos de Uso</h3>
      <div class="tree">
System Biblioteca
├── Usuário (ator)
│   ├── Cadastrar Livro
│   ├── Listar Livros
│   ├── Remover Livro
│   ├── Cadastrar Usuário
│   ├── Listar Usuários
│   └── Sair
</div>

      <h3>3.2 Diagrama de Classes (árvore resumida)</h3>
      <div class="tree">
com.fatec.biblioteca
├── Main
├── controller
│   └── BibliotecaController
├── factories
│   ├── LivroFactory
│   └── UsuarioFactory
├── model
│   ├── interfaces
│   │   └── BibliotecaRepository
│   ├── Biblioteca (implements BibliotecaRepository)
│   ├── Livro
│   └── usuarios
│       ├── Usuario (abstract)
│       ├── Aluno
│       ├── Professor
│       └── Bibliotecario
└── view
    └── BibliotecaView
</div>

    </section>

    <section class="section">
      <h2>4. Arquitetura em camadas</h2>
      <p>O projeto tem uma arquitetura em camadas simples e clara:</p>
      <ol>
        <li><strong>View</strong>: `BibliotecaView` — interação com o usuário (console).</li>
        <li><strong>Controller</strong>: `BibliotecaController` — coordena ações e aplica a inversão de dependência ao utilizar `BibliotecaRepository`.</li>
        <li><strong>Modelo</strong>: entidades `Livro`, `Usuario` e subclasses — regras de domínio locais (ex.: `emprestar`).</li>
        <li><strong>Persistência / Repositório</strong>: `Biblioteca` implementa `BibliotecaRepository` com armazenamento em memória.</li>
      </ol>
      <p>Fluxo: <code>View → Controller → Repository → Model</code></p>
    </section>

    <section class="section">
      <h2>5. Padrões de Projeto</h2>
      <ul>
        <li><strong>Singleton</strong> — `Biblioteca` (instância única do repositório).</li>
        <li><strong>Factory</strong> — `LivroFactory`, `UsuarioFactory` para criação de objetos.</li>
        <li><strong>Dependency Injection (manual)</strong> — `BibliotecaController` recebe `BibliotecaRepository` por construtor.</li>
        <li><strong>Repository</strong> — `BibliotecaRepository` como contrato de persistência.</li>
        <li><strong>MVC (simplificado)</strong> — separação clara entre view, controller e model.</li>
      </ul>
    </section>

    <section class="section">
      <h2>6. Plano de Testes</h2>
      <h3>6.1 Testes unitários implementados</h3>
      <ul>
        <li>`LivroTest` — getters, disponibilidade, emprestar/devolver, exceção ao emprestar indisponível.</li>
        <li>`LivroFactoryTest` — criação de livros.</li>
        <li>`UsuarioFactoryTest` — criação de cada tipo e casos de erro.</li>
        <li>`BibliotecaTest` — reset reflexivo do singleton, adicionar/listar/remover livros e usuários, teste de imutabilidade da lista.</li>
        <li>`BibliotecaControllerTest` — controller testado com `FakeRepo`.</li>
      </ul>

      <h3>6.2 Testes sugeridos</h3>
      <ul>
        <li>Testes de integração (View + Controller + Repository) simulando entradas do usuário.</li>
        <li>Testes de aceitação E2E rodando o jar com entradas predefinidas.</li>
        <li>Adicionar JaCoCo para medir cobertura e atingir metas (ex.: ≥80% linhas).</li>
      </ul>
    </section>

    <section class="section">
      <h2>7. Conclusão e recomendações</h2>
      <p>O sistema é um ponto de partida robusto para um protótipo de biblioteca. Recomenda-se:</p>
      <ul>
        <li>Adicionar JaCoCo para cobertura (próximo passo).</li>
        <li>Refatorar o singleton para possibilitar injeção completa e facilitar testes de integração.</li>
        <li>Adicionar validações em campos de entrada e tratamento de erros mais explícito.</li>
        <li>Expandir testes para view e fluxos de usuário (E2E).</li>
      </ul>

      <p class="footer">Relatório gerado automaticamente. Se desejar, posso adicionar diagramas visuais (PlantUML) ou integrar JaCoCo e gerar o relatório de cobertura agora.</p>
    </section>

    <footer>
      <p class="meta">Arquivo: <code>engineering_report.html</code></p>
    </footer>
  </div>
</body>
</html>
